<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <title>phonegap & jquery mobile boilerplate</title>
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />

  <link rel="stylesheet"  href="css/jquery.mobile.structure.css" />
  <link rel="stylesheet" href="css/jquery.mobile.theme.css" />
  <style type="text/css">
    #map{
    width: 100%;
    height: 70vh;
    background: #D1D0CE;
    }
    #getlocation{
      margin-top:5%;
      margin-bottom: 3%;
    }
    button.ui-btn { display: block; width: 100%; padding: 2%}
  </style>
  
  <script>
    var userAgent = navigator.userAgent + '';
    if (userAgent.indexOf('iPhone') > -1) {
      document.write('<script src="js/lib/cordova-iphone.js"></sc' + 'ript>');
      var mobile_system = 'iphone';
    } else if (userAgent.indexOf('Android') > -1) {
      document.write('<script src="js/lib/cordova-android.js"></sc' + 'ript>');
      var mobile_system = 'android';
    } else {
      var mobile_system = '';
    }
  </script>
  
  <script src="js/lib/jquery.js"></script>
  <!-- your scripts here -->
  <script src="js/app/app.js"></script>
  <script src="js/app/bootstrap.js"></script>
  <script src="js/lib/jquery.mobile.js"></script>
  <script src="http://maps.google.com/maps/api/js?key=AIzaSyDG0f5b69H-VMYH31cEnJypzfMDjDTyrBI" async defer></script>

  </head>
  <body>
    
    <div data-role="page">  

    	<div data-role="header">
    		<h1>GeoMap</h1>
    	</div><!-- /header -->

    	<div data-role="content">
        <button class="ui-btn" onclick="addMarker()">Get My Location</button>
   <div id="map"></div>
           
    	</div><!-- /content -->

    	<div data-role="footer">
    		<h4>All rights reserved @pages</h4>
    	</div><!-- /footer -->

    </div><!-- /page -->

    <script type="text/javascript">
      // Since we will be making use of 3rd party functions (eg. navigator.geolocation.getCurrentPosition) which are not native javascript functions we will need
// to add this function to the list of native javascript functions to allow javascript identify and execute it each time its called.
// This is done by using the addEventListener() function.
//
var longitude;
var latitude;
document.addEventListener("deviceready", onDeviceReady, false);


//We decide to create a function to handle the 3rd party functions (eg. navigator.geolocation.getCurrentPosition)
// which we earlier added to the native functions of the javascript
function onDeviceReady() {
    navigator.geolocation.getCurrentPosition(onSuccess, onError);
}

// onSuccess Geolocation
//
function onSuccess(position) {

   
    latitude = position.coords.latitude;
    longitude= position.coords.longitude;
        

        var latLng = new google.maps.LatLng(latitude, longitude);

        var mapDesc = {
            center: latLng,
            zoom: 10,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        // create the map here
        map = new google.maps.Map(document.getElementById("map"), mapDesc);
}

// onError Callback receives a PositionError object
//
function onError(error) {
    alert("Location Off: Please turn it on");
}


function addMarker(){
 // Add marker to the map
 var latLng = new google.maps.LatLng(latitude, longitude);
        var marker = new google.maps.Marker({
              position: latLng,
              map: map,
              title: 'My Current Location',
              animation: google.maps.Animation.DROP
          });
}
    </script>
  </body>
</html>
